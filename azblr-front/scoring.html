<!doctype html>
<html lang="ko">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/bootstrap/css/cover.css">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>AzeriteBlender: May the best traits win!</title>
  </head>
  <body>
    <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
      <header class="masthead mb-5">
        <div class="inner">
          <a class="navbar-brand" href="/"><h4 class="masthead-brand">AzrtBlndr</h4></a>
          <nav class="nav nav-masthead justify-content-center">
            <a class="nav-link" href="#" id="manual-button" data-toggle="modal" data-target="#manual-modal">사용법</a>
            <a class="d-none nav-link" href="/login.html" id="login-button">로그인</a>
            <a class="d-none nav-link" href="#" id="logout-button">로그아웃</a>
          </nav>
        </div>
      </header>
    
      <main role="main" class="inner cover">
        <div class="row">
          <form class="form-inline">
            <label class="sr-only" for="input-item-id">Item ID</label>
            <input type="text" class="form-control form-control-sm" id="input-item-id" placeholder="Item ID">
            <button type="button" class="btn btn-dark btn-sm">등록</button>
          </form>
        </div>
      </main>

    <!-- Modal -->
    <div class="modal fade" id="manual-modal" tabindex="-1" role="dialog" aria-labelledby="manual-modal-title" aria-hidden="true">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="manual-modal-title">Welcome to AzeriteBlender</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            Start the engine. May the best traits win!
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Optional JavaScript -->
    <script src="/js/jquery-3.3.1.min.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script>
      function GetURLParameter(sParam) {
        var sPageURL = window.location.search.substring(1)
        var sPageURL = window.location.search.substring(1)
        var sURLVariables = sPageURL.split('&')

        for (var i = 0; i < sURLVariables.length; i++) {
          var sParameterName = sURLVariables[i].split('=')
          if (sParameterName[0] == sParam) {
            return sParameterName[1];
          }
        }
      }
      
      $(document).ready(function() {
        // nav bar - login/out
        var tk = sessionStorage.getItem("azblr-tk")
        var _headers = {}
        _headers['Authorization'] = tk
        if (tk == null) {
          $('#login-button').removeClass('d-none')
        } else {
          $('#logout-button').removeClass('d-none')
          $('#logout-button').click(function() {
            $.ajax({
              url: 'http://localhost:5000/api/auth/logout',
              type: 'post',
              headers: _headers,
              success: function(data) {
                sessionStorage.removeItem("azblr-tk")
                location.reload()
              }
            })
          })
        }

        // main
        var class_id = GetURLParameter('class_id')
        var sp_id = GetURLParameter('sp_id')
        console.log(class_id)
        console.log(sp_id)
      })
    </script>
  </body>
</html>